{"title":{"en":"D. Weights Assignment For Tree Edges","ru":"D. Расстановка весов ребер корневого дерева"},"contestId":"1611","problemIndex":"D","timeLimit":{"en":"2 seconds","ru":"2 секунды"},"memLimit":{"en":"256 megabytes","ru":"256 мегабайт"},"inputFormat":{"en":"standard input","ru":"стандартный ввод"},"outputFormat":{"en":"standard output","ru":"стандартный вывод"},"problemHtml":{"en":"<p>You are given a rooted tree consisting of $$$n$$$ vertices. Vertices are numbered from $$$1$$$ to $$$n$$$. Any vertex can be the root of a tree.</p><p>A <span class=\"tex-font-style-it\">tree</span> is a connected undirected graph without cycles. A <span class=\"tex-font-style-it\">rooted tree</span> is a tree with a selected vertex, which is called the <span class=\"tex-font-style-it\">root</span>.</p><p>The tree is specified by an array of ancestors $$$b$$$ containing $$$n$$$ numbers: $$$b_i$$$ is an ancestor of the vertex with the number $$$i$$$. The <span class=\"tex-font-style-it\">ancestor</span> of a vertex $$$u$$$ is a vertex that is the next vertex on a simple path from $$$u$$$ to the root. For example, on the simple path from $$$5$$$ to $$$3$$$ (the root), the next vertex would be $$$1$$$, so the ancestor of $$$5$$$ is $$$1$$$.</p><p>The root has no ancestor, so for it, the value of $$$b_i$$$ is $$$i$$$ (the root is the only vertex for which $$$b_i=i$$$).</p><p>For example, if $$$n=5$$$ and $$$b=[3, 1, 3, 3, 1]$$$, then the tree looks like this.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/3d63b9472c8cdb7bb146905fa22f36e536eb93f7.png\" style=\"max-width: 100.0%;max-height: 100.0%;\">   <span class=\"tex-font-size-small\">An example of a rooted tree for $$$n=5$$$, the root of the tree is a vertex number $$$3$$$.</span> </center><p>You are given an array $$$p$$$&nbsp;— a permutation of the vertices of the tree. If it is possible, assign any <span class=\"tex-font-style-bf\">positive</span> integer weights on the edges, so that the vertices sorted by distance from the root would form the given permutation $$$p$$$.</p><p>In other words, for a given permutation of vertices $$$p$$$, it is necessary to choose such edge weights so that the condition $$$dist[p_i]&lt;dist[p_{i+1}]$$$ is true for each $$$i$$$ from $$$1$$$ to $$$n-1$$$. $$$dist[u]$$$ is a sum of the weights of the edges on the path from the root to $$$u$$$. In particular, $$$dist[u]=0$$$ if the vertex $$$u$$$ is the root of the tree.</p><p>For example, assume that $$$p=[3, 1, 2, 5, 4]$$$. In this case, the following edge weights satisfy this permutation:</p><ul> <li> the edge ($$$3, 4$$$) has a weight of $$$102$$$; </li><li> the edge ($$$3, 1$$$) has weight of $$$1$$$; </li><li> the edge ($$$1, 2$$$) has a weight of $$$10$$$; </li><li> the edge ($$$1, 5$$$) has a weight of $$$100$$$. </li></ul><p>The array of distances from the root looks like: $$$dist=[1,11,0,102,101]$$$. The vertices sorted by increasing the distance from the root form the given permutation $$$p$$$.</p><p>Print the required edge weights or determine that there is no suitable way to assign weights. If there are several solutions, then print any of them.</p>","ru":"<p>Вам задано корневое дерево из $$$n$$$ вершин. Вершины пронумерованы от $$$1$$$ до $$$n$$$. Корнем может быть любая из вершин.</p><p><span class=\"tex-font-style-it\">Дерево</span> — это связный неориентированный граф без циклов. <span class=\"tex-font-style-it\">Корневое дерево</span> — дерево с выделенной вершиной, которую называют <span class=\"tex-font-style-it\">корнем</span>.</p><p>Дерево задано массивом предков $$$b$$$, содержащим $$$n$$$ чисeл: $$$b_i$$$&nbsp;— предок вершины с номером $$$i$$$. Предком вершины $$$u$$$ называется такая вершина, которая является следующей вершиной на простом пути от $$$u$$$ к корню. Например, на простом пути из $$$5$$$ в $$$3$$$ (корень), следующая вершина будет $$$1$$$, таким образом, предком вершины $$$5$$$ является вершина $$$1$$$.</p><p>У корня предка нет, для него в качестве $$$b_i$$$ используется значение $$$i$$$ (таким образом, корень&nbsp;— единственная вершина, для которой $$$b_i=i$$$).</p><p>Например, если $$$n=5$$$ и $$$b=[3, 1, 3, 3, 1]$$$, то дерево выглядит следующим образом.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/3d63b9472c8cdb7bb146905fa22f36e536eb93f7.png\" style=\"max-width: 100.0%;max-height: 100.0%;\">   <span class=\"tex-font-size-small\">Пример корневого дерева для $$$n=5$$$, корень дерева&nbsp;— вершина $$$3$$$.</span> </center><p>Задан массив $$$p$$$&nbsp;— <span class=\"tex-font-style-it\">перестановка</span> вершин дерева. Если это возможно, расставьте целочисленные <span class=\"tex-font-style-bf\">положительные</span> веса на всех ребрах данного дерева так, чтобы вершины, отсортированные по увеличению расстояния от корня, образовывали заданную перестановку $$$p$$$.</p><p>Иными словами, по заданной перестановке вершин $$$p$$$ необходимо подобрать такие положительные веса рёбер, чтобы выполнялось неравенство $$$dist[p_i]&lt;dist[p_{i+1}]$$$ для всех $$$i$$$ от $$$1$$$ до $$$n-1$$$, где $$$dist[u]$$$&nbsp;— сумма весов рёбер на пути от корня до $$$u$$$. В частности, $$$dist[u]=0$$$, если вершина $$$u$$$ является корнем дерева.</p><p>Например, пусть $$$p=[3, 1, 2, 5, 4]$$$. В этом случае следующие веса ребер удовлетворяют этой перестановке:</p><ul> <li> ребро ($$$3, 4$$$) имеет вес $$$102$$$; </li><li> ребро ($$$3, 1$$$) имеет вес $$$1$$$; </li><li> ребро ($$$1, 2$$$) имеет вес $$$10$$$; </li><li> ребро ($$$1, 5$$$) имеет вес $$$100$$$. </li></ul><p>В этом случае массив расстояний от корня имеет вид: $$$dist=[1,11,0,102,101]$$$. Если вершины отсортировать по возрастанию расстояний, то получится заданная перестановка $$$p$$$.</p><p>Выведите искомые веса рёбер или определите, что подходящего способа назначить веса не существует. Если решений несколько, то выведите любое из них.</p>"},"inSpecsHtml":{"en":"<div class=\"section-title\">Input</div><p>The first line of input data contains an integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$) — the number of input data sets in the test.</p><p>Each test case consists of three lines.</p><p>The first of them contains an integer $$$n$$$ ($$$1 \\le n \\le 2 \\cdot 10^5$$$). It is the number of vertices in the tree.</p><p>The second line contains $$$n$$$ integers $$$b_1, b_2, \\dots, b_n$$$ ($$$1 \\le b_i \\le n$$$). It is guaranteed that the $$$b$$$ array encodes some rooted tree.</p><p>The third line contains the given permutation $$$p$$$: $$$n$$$ of different integers $$$p_1, p_2, \\dots, p_n$$$ ($$$1 \\le p_i \\le n$$$).</p><p>It is guaranteed that the sum of the values $$$n$$$ over all test cases in the test does not exceed $$$2 \\cdot 10^5$$$.</p>","ru":"<div class=\"section-title\">Входные данные</div><p>В первой строке входных данных записано целое число $$$t$$$ ($$$1 \\le t \\le 10^4$$$) — количество наборов входных данных в тесте.</p><p>Каждый набор входных данных состоит из трех строк.</p><p>В первой из них записано целое число $$$n$$$ ($$$1 \\le n \\le 2 \\cdot 10^5$$$) — количество вершин в дереве.</p><p>Во второй записано $$$n$$$ целых чисел $$$b_1, b_2, \\dots, b_n$$$ ($$$1 \\le b_i \\le n$$$). Гарантируется, что массив $$$b$$$ кодирует некоторое корневое дерево.</p><p>В третьей строке задана перестановка $$$p$$$: $$$n$$$ различных целых чисел $$$p_1, p_2, \\dots, p_n$$$ ($$$1 \\le p_i \\le n$$$).</p><p>Гарантируется, что сумма значений $$$n$$$ по всем наборам входных данных в тесте не превосходит $$$2 \\cdot 10^5$$$.</p>"},"outSpecsHtml":{"en":"<div class=\"section-title\">Output</div><p>For each set of input data print the answer on a separate line.</p><p>If the solution exists, print an array of $$$n$$$ integers $$$w_1, w_2, \\dots, w_n$$$, where $$$w_i$$$ is the weight of the edge that leads from $$$b_i$$$ to $$$i$$$. For the root there is no such edge, so use the value $$$w_i=0$$$. For all other vertices, the values of $$$w_i$$$ must satisfy the inequality $$$1 \\le w_i \\le 10^9$$$. There can be equal numbers among $$$w_i$$$ values, but all sums of weights of edges from the root to vertices must be different and satisfy the given permutation.</p><p>If there are several solutions, output any of them.</p><p>If no solution exists, output <span class=\"tex-font-style-tt\">-1</span>.</p>","ru":"<div class=\"section-title\">Выходные данные</div><p>Для каждого набора входных данных выведите ответ на отдельной строке.</p><p>Если решение существует, то выведите массив из $$$n$$$ целых чисел $$$w_1, w_2, \\dots, w_n$$$, где $$$w_i$$$ — вес ребра, которое ведёт из $$$b_i$$$ в $$$i$$$. Для корня такого ребра не существует, поэтому используйте значение $$$w_i=0$$$. Для всех остальных вершин значения $$$w_i$$$ должны удовлетворять неравенству $$$1 \\le w_i \\le 10^9$$$. Среди значений $$$w_i$$$ могут быть равные числа, но все суммы весов ребер от корня до вершин должны быть различны и удовлетворять заданной перестановке.</p><p>Если решений несколько, выведите любое из них.</p><p>Если решения не существует, то выведите <span class=\"tex-font-style-tt\">-1</span>.</p>"},"noteHtml":{"en":"<div class=\"section-title\">Note</div><p>The first set of input data of the example is analyzed in the main part of the statement.</p><p>In the second set of input data of the example, it is impossible to assign the positive weights to obtain a given permutation of vertices.</p>","ru":"<div class=\"section-title\">Примечание</div><p>Первый набор входных данных примера разобран в основной части условия.</p><p>Во втором наборе входных данных примера невозможно расставить целочисленные положительные веса так, чтобы получить заданную перестановку вершин.</p>"},"sampleTestcases":[{"id":1638656451157,"input":"4\n5\n3 1 3 3 1\n3 1 2 5 4\n3\n1 1 2\n3 1 2\n7\n1 1 2 3 4 5 6\n1 2 3 4 5 6 7\n6\n4 4 4 4 1 1\n4 2 1 5 6 3\n","output":"1 10 0 102 100\n-1\n0 3 100 1 1 2 4\n6 5 10 0 2 3"}],"submitUrl":"https://codeforces.com/contest/1611/submit","language":"python"}